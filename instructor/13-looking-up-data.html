<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Library Carpentry: OpenRefine: Looking Up Data</title><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" type="text/css" href="../assets/styles.css"><script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="manifest" href="../site.webmanifest"><link rel="mask-icon" href="../safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"></head><body>
    <header id="top" class="navbar navbar-expand-md navbar-light bg-white top-nav library"><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-6">
      <div class="large-logo">
        <img alt="Library Carpentry" src="../assets/images/library-logo.svg"></div>
    </div>
    <div class="selector-container">
      
      
      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='../13-looking-up-data.html';">Learner View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl navbar-light bg-white bottom-nav library" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Library Carpentry" src="../assets/images/library-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Library Carpentry: OpenRefine
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
      <i role="img" aria-label="search button" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Library Carpentry: OpenRefine
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"></ul></li>
      </ul></div>
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled><input class="form-control me-2 searchbox" type="search" placeholder="Search" aria-label="Search"><button class="btn btn-outline-success tablet-search-button" type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="search button"></i>
        </button>
      </fieldset></form>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Library Carpentry: OpenRefine
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 85%" class="percentage">
    85%
  </div>
  <div class="progress library">
    <div class="progress-bar library" role="progressbar" style="width: 85%" aria-valuenow="85" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../13-looking-up-data.html">Learner View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->
      
            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="01-introduction.html">1. Introduction to OpenRefine</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="02-importing-data.html">2. Importing data into OpenRefine</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="03-working-with-data.html">3. Layout of OpenRefine, Rows vs Records</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="04-faceting-and-filtering.html">4. Faceting and filtering</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="05-clustering.html">5. Clustering</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="06-working-with-columns.html">6. Working with columns and sorting</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="07-introduction-to-transformations.html">7. Introduction to Transformations</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="08-writing-transformations.html">8. Writing Transformations</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush10">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading10">
        <a href="09-undo-and-redo.html">9. Transformations - Undo and Redo</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush11">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading11">
        <a href="10-data-transformation.html">10. Transforming Strings, Numbers, Dates and Booleans</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush12">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading12">
        <a href="11-using-arrays-transformations.html">11. Transformations - Handling Arrays</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush13">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading13">
        <a href="12-export-transformation.html">12. Exporting data</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        13. Looking Up Data
        </span>
      </button>
    </div><!--/div.accordion-header-->
        
    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#looking-up-data-from-a-url">Looking up data from a URL</a></li>
<li><a href="#reconciliation-services">Reconciliation services</a></li>
<li><a href="#using-the-cross-function-to-lookup-data-in-other-openrefine-projects">Using the ‘cross’ function to lookup data in other OpenRefine
projects</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width resources"><a href="../instructor/aio.html">See all in one page</a>
            

            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">
            
            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/12-export-transformation.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/index.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/12-export-transformation.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Exporting data
        </a>
        <a class="chapter-link float-end" href="../instructor/index.html" rel="next">
          Home
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Looking Up Data</h1>
        <p> Last updated on 2023-08-28 | 
        
        <a href="https://github.com/librarycarpentry/lc-open-refine/edit/main/episodes/13-looking-up-data.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
        
        
        
        <p>Estimated time <i aria-hidden="true" data-feather="clock"></i> 30 minutes </p>
        
        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>How do I fetch data from an Application Programming Interface (API)
to be used in OpenRefine?</li>
<li>How do I reconcile my data by comparing it to authoritative
datasets</li>
<li>How do I install extensions for OpenRefine</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li>Use URLs to fetch data from the web based on columns in an
OpenRefine project</li>
<li>Add columns to parse JSON data returned by web services</li>
<li>Understand how Reconciliation services are used to validate
data</li>
<li>Add functionality using OpenRefine extensions</li>
</ul></div>
</div>
</div>
</div>
</div>
<section id="looking-up-data-from-a-url"><h2 class="section-heading">Looking up data from a URL<a class="anchor" aria-label="anchor" href="#looking-up-data-from-a-url"></a>
</h2>
<hr class="half-width"><p>OpenRefine can retrieve data from URLs. This can be used in various
ways, including looking up additional information from a remote service,
based on information in your OpenRefine data.</p>
<p>As an example, you can look up names against the Virtual
International Authority File (VIAF), and retrieve additional information
such as dates of birth/death and identifiers.</p>
<p>Typically this is a two step process, firstly a step to retrieve data
from a remote service, and secondly to extract the relevant information
from the data you have retrieved.</p>
<p>To retrieve data from an external source, use the drop down menu at
any column heading and select ‘Edit column-&gt;Add column by fetching
URLs’.</p>
<p>This will prompt you for a GREL expression to create a URL. Usually
this would be a URL that uses existing values in your data to build a
query. When the query runs OpenRefine will request each URL (for each
line) and retrieve whatever data is returned (this may often be
structured data, but could be HTML).</p>
<p>The data retrieved will be stored in a cell in the new column that
has been added to the project. You can then use OpenRefine
transformations to extract relevant information from the data that has
been retrieved. Two specific OpenRefine functions used for this are:</p>
<ul><li>parseHtml()</li>
<li>parseJson()</li>
</ul><p>The ‘parseHtml()’ function can also be used to extract data from
XML.</p>
<p>The next exercise demonstrates this two stage process in full.</p>
<div id="retrieving-journal-details-from-crossref-via-issn" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="retrieving-journal-details-from-crossref-via-issn" class="callout-inner">
<h3 class="callout-title">Retrieving journal details from CrossRef via
ISSN<a class="anchor" aria-label="anchor" href="#retrieving-journal-details-from-crossref-via-issn"></a>
</h3>
<div class="callout-content">
<p>Because retrieving data from external URLs takes time, this exercise
targets a single line in the data. In reality you would want to run this
over many rows (and probably go and do something else while it ran).</p>
<ul><li>Select a single row from the data set which contains an ISSN by:
<ul><li>Clicking the star icon for the relevant row in the first column</li>
<li>Facet by Star</li>
<li>Choose the single row</li>
</ul></li>
<li>In the ISSN column use the dropdown menu to choose ‘Edit
column-&gt;Add column by fetching URLs’</li>
<li>Give the column a name e.g. “Journal_details”</li>
<li>In the expression box you need to write some GREL where the output
of the expression is a URL which can be used to retrieve data (the
format of the data could be HTML, XML, JSON, or some other text
format)</li>
</ul><p>In this case we are going to use the CrossRef API: <a href="https://api.crossref.org/" class="external-link">https://api.crossref.org/</a>. Read
more about the CrossRef service: <a href="https://crossref.org" class="external-link">https://crossref.org</a>. Note that API
providers may impose rate limits or have other requirements for using
their data, so it’s important to check the site’s documentation. To
comply with API rate limits, use the Throttle Delay setting to specify
the number of milliseconds between URL requests. CrossRef, for instance,
<a href="https://www.crossref.org/documentation/retrieve-metadata/rest-api/tips-for-using-the-crossref-rest-api/#pick-the-right-service-level" class="external-link">asks
users</a> to “specify a User-Agent header that properly identifies your
script or tool and that provides a means of contacting you via email
using ‘mailto:’.” User-agent headers provide administrators with user
information that facilitates better administration and moderation of the
API, and it is generally good etiquette to include a header with any API
request.</p>
<p>To edit your User-Agent header:</p>
<ul><li>Click ‘Show’ (next to ‘HTTP headers to be used when fetching URLs’).
Note that OpenRefine has already populated the ‘User-Agent’ field with
information about the version of OpenRefine you are using; it should
look similar to <code>OpenRefine 3... [...]</code> (the information
following <code>OpenRefine</code> will depend on the version of
OpenRefine you are using).</li>
<li>At the end of the existing text, add
<code>; mailto:address@library.edu</code>, using your own email address.
The full User-Agent field should now be similar to
<code>OpenRefine 3... [...]; mailto:address@library.edu</code> but
reflect your version information and email address.</li>
</ul><p>The syntax for requesting journal information from CrossRef is
<code>https://api.crossref.org/journals/{ISSN}</code> where {ISSN} is
replaced with the ISSN of the journal</p>
<ul><li>In the expression box type the GREL
<code>"https://api.crossref.org/journals/"+value</code>
</li>
</ul><p>At this point, your screen should be similar to this: <img src="../fig/openrefine_add_columns_by_url.png" alt="Add column by fetching URLs screen capture" class="figure"></p>
<ul><li>Click ‘OK’</li>
</ul><p>You should see a message at the top on the OpenRefine screen
indicating it is fetching some data, with progress showing the
percentage of the proportion of rows of data successfully being fetched.
Wait for this to complete. Fetching data for a single row should take
only ten seconds or so, but fetching data for all rows will take longer.
You can speed this up by modifying the “Throttle Delay” setting in the
‘Add column by fetching URLs’ dialog which controls the delay between
each URL request made by OpenRefine. This is defaulted to a rather large
5000 milliseconds (5 seconds).</p>
<p>At this point you should have a new cell containing a long text
string in a format called ‘JSON’ (this stands for JavaScript Object
Notation, although very rarely spelt out in full).</p>
<p>OpenRefine has a function for extracting data from JSON (sometimes
referred to as ‘parsing’ the JSON). The ‘parseJson’ function is
explained in more detail at <a href="https://docs.openrefine.org/manual/grelfunctions/#format-based-functions-json-html-xml" class="external-link">https://docs.openrefine.org/manual/grelfunctions/#format-based-functions-json-html-xml</a>.</p>
<ul><li>In the new column you’ve just added use the dropdown menu to access
‘Edit column-&gt;Add column based on this column’</li>
<li>Add a name for the new column e.g. “Journal_title”</li>
<li>In the Expression box type the GREL
<code>value.parseJson().message.title</code>
</li>
<li>You should see in the Preview the Journal title displays</li>
</ul><p>The reason for using ‘Add column based on this column’ is that this
allows you to retain the full JSON and extract further data from it if
you need to. If you only wanted the title and did not need any other
information from the JSON you could use ‘Edit cells-&gt;Transform…’ with
the same GREL expression.</p>
</div>
</div>
</div>
</section><section id="reconciliation-services"><h2 class="section-heading">Reconciliation services<a class="anchor" aria-label="anchor" href="#reconciliation-services"></a>
</h2>
<hr class="half-width"><p>Reconciliation services allow you to lookup terms from your data in
OpenRefine against external services, and use values from the external
services in your data. The official User Manual provides <a href="https://docs.openrefine.org/manual/reconciling" class="external-link">detailed
information about the reconciliation feature</a>.</p>
<p>Reconciliation services can be more sophisticated and often quicker
than using the method described above to retrieve data from a URL.
However, to use the ‘Reconciliation’ function in OpenRefine requires the
external resource to support the necessary service for OpenRefine to
work with, which means unless the service you wish to use supports such
a service you cannot use the ‘Reconciliation’ approach.</p>
<p>There are a few services where you can find an OpenRefine
Reconciliation option available. For example Wikidata has a
reconciliation service at <a href="https://wikidata.reconci.link/" class="external-link">https://wikidata.reconci.link/</a>.</p>
<p>In other cases people have built reconciliation applications for a
specific service which you can download and run yourself. These vary in
how they work, and what it takes to run them locally. For example there
are multiple reconciliation applications for VIAF. Even for the same
service (e.g. VIAF) different reconciliation applications (written by
different people) can work in different ways and potentially give
different results - so caveat emptor!</p>
<p>One of the most common ways of using the reconciliation option in
OpenRefine is with an extension (see below for more on extensions to
OpenRefine) which can use linked data sources for reconciliation. The
RDF extension by Stuart Kenny can be downloaded from <a href="https://github.com/stkenny/grefine-rdf-extension/releases" class="external-link">https://github.com/stkenny/grefine-rdf-extension/releases</a>.</p>
<p>Other extensions are available to do reconciliation against local
data such as csv files (see <a href="https://okfnlabs.org/reconcile-csv/" class="external-link">http://okfnlabs.org/reconcile-csv/</a>)
and maintained lists of values (see <a href="https://okfnlabs.org/projects/nomenklatura/index.html" class="external-link">http://okfnlabs.org/projects/nomenklatura/index.html</a>).</p>
<p>For more information on using Reconciliation services see <a href="https://docs.openrefine.org/manual/reconciling" class="external-link">https://docs.openrefine.org/manual/reconciling</a>.</p>
<div id="reconcile-publisher-names-with-viaf-ids" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="reconcile-publisher-names-with-viaf-ids" class="callout-inner">
<h3 class="callout-title">Reconcile Publisher names with VIAF IDs<a class="anchor" aria-label="anchor" href="#reconcile-publisher-names-with-viaf-ids"></a>
</h3>
<div class="callout-content">
<p>In this exercise you are going to use the VIAF Reconciliation service
written by <a href="https://twitter.com/absolutelyjeff" class="external-link">Jeff Chiu</a>.
Jeff offers two ways of using the reconciliation service - either via a
public service he runs at <a href="https://refine.codefork.com/" class="external-link">http://refine.codefork.com/</a>, or
by installing and running the service locally using the instructions at
<a href="https://github.com/codeforkjeff/conciliator" class="external-link">https://github.com/codeforkjeff/conciliator</a>.</p>
<p>If you are going to do a lot of reconciliation, please install and
run your own local reconciliation service following the instructions at
<a href="https://github.com/codeforkjeff/conciliator#running-conciliator-on-your-own-computer" class="external-link">https://github.com/codeforkjeff/conciliator</a>.</p>
<p>Once you have chosen which service you are going to use:</p>
<ul><li>In the Publisher column use the dropdown menu to choose
‘Reconcile-&gt;Start Reconciling’</li>
<li>If this is the first time you’ve used this particular reconciliation
service, you’ll need to add the details of the service now
<ul><li>Click ‘Add Standard Service…’ and in the dialogue that appears
enter:
<ul><li>“<a href="https://refine.codefork.com/reconcile/viaf" class="external-link">https://refine.codefork.com/reconcile/viaf</a>”
for Jeff’s public service</li>
<li>“<a href="https://localhost:8080/reconcile/viaf" class="external-link">http://localhost:8080/reconcile/viaf</a>”
if you are running the service locally</li>
</ul></li>
</ul></li>
<li>You should now see a heading in the list on the left hand side of
the Reconciliation dialogue called “VIAF”</li>
<li>Click on this to choose to use this reconciliation service</li>
<li>In the middle box in the reconciliation dialogue you may get asked
what type of ‘entity’ you want to reconcile to - that is, what type of
thing are you looking for. The list will vary depending on what
reconciliation service you are using.
<ul><li>In this case choose “Corporate Name” (it seems like the VIAF
Reconciliation Service is slightly intelligent about this and will only
offer options that are relevant)</li>
</ul></li>
<li>In the box on the righthand side of the reconciliation dialogue you
can choose if other columns are used to help the reconciliation service
make a match - however it is sometimes hard to tell what use (if any)
the reconciliation service makes of these additional columns</li>
<li>At the bottom of the reconciliation dialogue there is the option to
“Auto-match candidates with high confidence”. This can be a time saver,
but in this case you are going to uncheck it, so you can see the results
before a match is made</li>
<li>Now click ‘Start Reconciling’</li>
</ul><p>Reconciliation is an operation that can take a little time if you
have many values to look up. However, in this case there are only 6
publishers to check, so it should work quite quickly.</p>
<p>Once the reconciliation has completed two Facets should be created
automatically:</p>
<ul><li>Publisher: Judgement</li>
<li>Publisher: best candidate’s score</li>
</ul><p>These are two of several specific reconciliation facets and actions
that you can get from the ‘Reconcile’ menu (from the column drop down
menu).</p>
<ul><li>Close the ‘Publisher: best candidate’s score’ facet, but leave the
‘Publisher: Judgement’ facet open</li>
</ul><p>If you look at the Publisher column, you should see some cells have
found one or more matches - the potential matches are shown in a list in
each cell. Next to each potential match there is a ‘tick’ and a ‘double
tick’. To accept a reconciliation match you can use the ‘tick’ options
in cells. The ‘tick’ accepts the match for the single cell, the ‘double
tick’ accepts the match for all identical cells.</p>
<ul><li>Create a text facet on the Publisher column</li>
<li>Choose ‘International Union of Crystallography’</li>
</ul><p>In the Publisher column you should be able to see the various
potential matches. Clicking on a match will take you to the VIAF page
for that entity.</p>
<ul><li>Click a ‘double tick’ in one of the Publisher column cells for the
option “International Union of Crystallography”</li>
<li>This will accept this as a match for all cells - you should see the
other options all disappear</li>
<li>Check the ‘Publisher: Judgement’ facet. This should now show that
858 items are ‘matched’ (if this does not update, try refreshing the
facets)</li>
</ul><p>We could do these one by one, but if we are confident with the
matches, there is an option to accept all:</p>
<ul><li>Remove all filters/facets from the project so all rows display</li>
<li>In the Publisher column use the dropdown menu to choose
‘Reconcile-&gt;Actions-&gt;Match each cell to its best candidate’</li>
</ul><p>There are two things that reconciliation can do for you. Firstly it
gets a standard form of the name or label for the entity. Secondly it
gets an ID for the entity - in this case a VIAF id. This is hidden in
the default view, but can be extracted:</p>
<ul><li>In the Publisher column use the dropdown menu to choose ‘Edit
column-&gt;Add column based on this column…’</li>
<li>Give the column the name ‘VIAF-ID’</li>
<li>In the GREL expression box type
<code>cell.recon.match.id</code>
</li>
<li>This will create a new column that contains the VIAF ID for the
matched entity</li>
</ul></div>
</div>
</div>
</section><section id="using-the-cross-function-to-lookup-data-in-other-openrefine-projects"><h2 class="section-heading">Using the ‘cross’ function to lookup data in other OpenRefine
projects<a class="anchor" aria-label="anchor" href="#using-the-cross-function-to-lookup-data-in-other-openrefine-projects"></a>
</h2>
<hr class="half-width"><p>As well as looking up data in external systems using the methods
described above, it is also possible to look up data in other OpenRefine
projects on the same computer. This is done using the ‘cross’
function.</p>
<p>The ‘cross’ function takes a value from the OpenRefine project you
are working on, and looks for that value in a column in another
OpenRefine project. If it finds one or more matching rows in the second
OpenRefine project, it returns an array containing the rows that it has
matched.</p>
<p>As it returns the whole row for each match, you can use a
transformation to extract the values from any of the columns in the
second project.</p>
<p>You can use this function to compare the contents of two OpenRefine
projects, or to use data between the two projects.</p>
<p>The VIB-Bits extension adds a number of very useful functions to
OpenRefine. One of them is “Add column(s) from other projects…”, which
provides a dialog window to help you work with the <code>cross</code>
function with less typing.</p>
<div id="extensions" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="extensions" class="callout-inner">
<h3 class="callout-title">Extensions<a class="anchor" aria-label="anchor" href="#extensions"></a>
</h3>
<div class="callout-content">
<p>The functionality in OpenRefine can be enhanced by ‘extensions’ which
can be downloaded and installed to add functionality to your OpenRefine
installation.</p>
<p>A list of Extensions (not necessarily complete) is given on the
OpenRefine downloads page at <a href="https://openrefine.org/download.html" class="external-link">http://openrefine.org/download.html</a>.</p>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Keypoints<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul><li>OpenRefine can look up custom URLs to fetch data based on what’s in
an OpenRefine project</li>
<li>Such API calls can be custom built, or one can use existing
Reconciliation services to enrich data</li>
<li>OpenRefine can be further enhanced by installing extensions</li>
</ul></div>
</div>
</div>
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/12-export-transformation.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/index.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/12-export-transformation.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Exporting data
        </a>
        <a class="chapter-link float-end" href="../instructor/index.html" rel="next">
          Home
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
				<p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>
        
        <a href="https://github.com/librarycarpentry/lc-open-refine/edit/main/episodes/13-looking-up-data.md" class="external-link">Edit on GitHub</a>
        
	
        | <a href="https://github.com/librarycarpentry/lc-open-refine/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a> 
        | <a href="https://github.com/librarycarpentry/lc-open-refine/" class="external-link">Source</a></p>
				<p><a href="https://github.com/librarycarpentry/lc-open-refine/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:team@carpentries.org">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">
        
        <p>Materials licensed under <a href="../LICENSE.html">CC-BY 4.0</a> by the authors</p>
        
        <p><a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">Template licensed under CC-BY 4.0</a> by <a href="https://carpentries.org" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.14.1" class="external-link">sandpaper (0.14.1)</a>,
        <a href="https://github.com/carpentries/pegboard/tree/0.7.1" class="external-link">pegboard (0.7.1)</a>,
      and <a href="https://github.com/carpentries/varnish/tree/0.3.3" class="external-link">varnish (0.3.3)</a>.</p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
			<i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back to top"></i><br><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://librarycarpentry.github.io/lc-open-refine/instructor/13-looking-up-data.html",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "Looking Up Data",
  "creativeWorkStatus": "active",
  "url": "https://librarycarpentry.github.io/lc-open-refine/instructor/13-looking-up-data.html",
  "identifier": "https://librarycarpentry.github.io/lc-open-refine/instructor/13-looking-up-data.html",
  "dateCreated": "2018-04-12",
  "dateModified": "2023-08-28",
  "datePublished": "2023-11-14"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo
    2022-11-07: we have gotten a notification that we have an overage for our
    tracking and I'm pretty sure this has to do with Workbench usage.
    Considering that I am not _currently_ using this tracking because I do not
    yet know how to access the data, I am turning this off for now.
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
    _paq.push(["setDomains", ["*.preview.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
    _paq.push(["setDoNotTrack", true]);
    _paq.push(["disableCookies"]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
          var u="https://carpentries.matomo.cloud/";
          _paq.push(['setTrackerUrl', u+'matomo.php']);
          _paq.push(['setSiteId', '1']);
          var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
          g.async=true; g.src='https://cdn.matomo.cloud/carpentries.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
  </script>
  End Matomo Code --></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

